(function(){dust.register("party.detail",body_0);function body_0(chk,ctx){return chk.write("<input type=\"hidden\" id=\"hiddenPartyID\" value=\"").reference(ctx.getPath(false, ["item","_id"]),ctx,"h").write("\"><div class=\"form-group\"><div class=\"col-sm-12\"><ul class=\"nav nav-tabs\"><li class=\"active\"><a href=\"#securityInfo\" data-toggle=\"tab\">设置安全信息</a></li><li><a href=\"#interface\" data-toggle=\"tab\">分配接口</a></li></ul></div></div><div class=\"col-sm-12 tab-content\"><div class=\"tab-pane active\" id=\"securityInfo\"><div class=\"form-group\"><div class=\"col-sm-12\"><div class=\"row text-left\"><label   class=\"col-sm-1 control-label\">公钥</label><div class=\"col-sm-2\"><input type=\"hidden\" value=\"").reference(ctx.getPath(false, ["item","security","publicKey"]),ctx,"h").write("\" class=\"form-control\" id=\"publicKeyValue\"><a href=\"#\" class=\"form-control\" id=\"publicKey\" data-type=\"textarea\" data-pk=\"1\"  data-title=\"公钥\" ><i class=\"icon-file-alt icon-large\"></i>查看</a></div><label   class=\"col-sm-1 control-label\">私钥</label><div class=\"col-sm-2\"><input type=\"hidden\" value=\"").reference(ctx.getPath(false, ["item","security","privateKey"]),ctx,"h").write("\" id=\"privateKeyValue\"><a href=\"#\" class=\"form-control\" id=\"privateKey\"  data-type=\"textarea\" data-pk=\"1\"  data-title=\"私钥\" ><i class=\"icon-file-alt icon-large\"></i>查看</a></div><div class=\"col-sm-4\">").exists(ctx.getPath(false, ["item","security","publicKey"]),ctx,{"else":body_1,"block":body_2},null).write("<p class=\"help-block\">此密钥对用来对下面的密钥进行加密解密</p></div></div></div></div><div class=\"col-sm-12\"><div class=\"row text-left\"><label for=\"salt\"  class=\"col-sm-1 control-label\">salt</label><div class=\"col-sm-2\"><input type=\"text\" value=\"\" class=\"form-control\" id=\"salt\"></div><label for=\"hmacKey\"  class=\"col-sm-1 control-label\">key</label><div class=\"col-sm-6\"><input type=\"text\" value=\"").reference(ctx.getPath(false, ["item","security","hmacKey"]),ctx,"h").write("\" readonly class=\"form-control\" id=\"hmacKey\"><p class=\"help-block\">此密钥可用来对报文进行hmac散列，或对报文进行加密</p></div><div class=\"col-sm-2\">").exists(ctx.getPath(false, ["item","security","hmacKey"]),ctx,{"else":body_3,"block":body_4},null).write("</div></div></div></div><div class=\"tab-pane\" id=\"interface\"><div class=\"row\"><div class=\"col-sm-12\"><div class=\"form-group\"><div id=\"interfacesDiv\" class=\"col-sm-12\"></div></div></div></div><div class=\"row text-left\"><div class=\"panel panel-default\"><div class=\"panel-heading\"><a class=\"btn btn-default\" id=\"showAddBtn\" data-toggle=\"collapse\" data-parent=\"#mainContent\" href=\"#addBody\">添加接口</a></div><div id=\"addBody\" class=\"panel-collapse collapse\"><div class=\"panel-body\"><div class=\"col-sm-4\"><div class=\"form-group\">").helper("baseCode",ctx,{},{"id":"interfaceCategory","blankValue":"所有类别","name":"category","base":"interfaceCategory","blank":"true"}).helper("baseCode",ctx,{},{"id":"interfaceProvider","blankValue":"所有提供方","name":"provider","base":"interfaceProvider","blank":"true"}).write("<a href=\"#\" id=\"addInterfaceButton\" title=\"添加\" class=\"btn btn-primary\">添加</a></div></div></div></div></div></div></div></div><script type=\"text/javascript\">$(function() {$('#publicKey').editable({tpl: \"<textarea cols='80'></textarea>\",rows: 12,display: false,showbuttons: false,value: function() {return $('#publicKeyValue').val();}});$('#privateKey').editable({tpl: \"<textarea cols='80'></textarea>\",rows: 15,display: false,showbuttons: false,value: function() {return $('#privateKeyValue').val();}});$('#createKeyPairBtn').click(function(event) {var id = $('#hiddenPartyID').val();var publicKey = $('#publicKeyValue').val();var privateKey = $('#privateKey').val();if (publicKey || privateKey) {return false;}$.get(\"/party/\" + id + \"/createKeyPair?\" + new Date().getTime(), function(data, status, xhr) {if (status === 'success') {app.showSucess('成功生成，请点击查看');partyObj.renderDetail(id, data);} else {app.showError(xhr.statusText);}});});$('#deleteKeyPairBtn').click(function(event) {var id = $('#hiddenPartyID').val();var publicKey = $('#publicKeyValue').val();var privateKey = $('#privateKeyValue').val();if (!publicKey || !privateKey) {return false;}$.get(\"/party/\" + id + \"/deleteKeyPair?\" + new Date().getTime(), function(data, status, xhr) {if (status === 'success') {app.showSucess('成功删除');partyObj.renderDetail(id, data);} else {app.showError(xhr.statusText);}});});$('#createKeyBtn').click(function(event) {var id = $('#hiddenPartyID').val();var hmacKey = $('#hmacKey').val();var salt = $('#salt').val();if (hmacKey) {return false;}if (!salt) {return app.showError('salt不能为空');}$.get(\"/party/\" + id + \"/\" + salt + \"/createKey?\" + new Date().getTime(), function(data, status, xhr) {if (status === 'success') {app.showSucess('成功生成');partyObj.renderDetail(id, data);} else {app.showError(xhr.statusText);}});});var showInterfaces = function() {var id = $('#hiddenPartyID').val();var category = $('#interfaceCategory').val();var provider = $('#interfaceProvider').val();$('#interfaces').remove();$.get(\"/interface/query?category=\" + category + \"&provider=\" + provider + \"&\" + new Date().getTime(), function(data, status, xhr) {if (status === 'success') {var list = data.list;var select = $('<select name=\"interfaces\" class=\"form-control\" id=\"interfaces\"></select>');for (var i = 0, l = list.length; i < l; i ++) {select.append('<option value=\"' + list[i]._id + '\">' + list[i].name + '</option>')}$('select:last').after(select);} else {app.showError(xhr.statusText);}});};$('#addBody').on('show.bs.collapse', function () {showInterfaces();});$('#interfaceCategory, #interfaceProvider').change(function(event) {showInterfaces();});$('#addInterfaceButton').click(function(event) {var id = $('#hiddenPartyID').val();var inter = $('#interfaces').val();$.get(\"/party/\" + id + \"/addInterface/\" + inter + \"?\" + new Date().getTime(), function(data, status, xhr) {if (status === 'success') {if (data.err) {return app.showError(data.err);}app.showSucess(data.message, function() {data.user = app.user;partyObj.renderInterfaces(id, data);});} else {app.showError(xhr.statusText);}});});});</script>");}function body_1(chk,ctx){return chk.write("<button type=\"button\" class=\"btn btn-default\" id=\"createKeyPairBtn\">生成密钥对</button>");}function body_2(chk,ctx){return chk.write("<button type=\"button\" class=\"btn btn-primary\" id=\"deleteKeyPairBtn\">删除密钥对</button>");}function body_3(chk,ctx){return chk.write("<button type=\"button\" class=\"btn btn-default\" id=\"createKeyBtn\">生成密钥</button>");}function body_4(chk,ctx){return chk.write("<button type=\"button\" class=\"btn btn-primary\" id=\"deleteKeyPairBtn\">删除密钥</button>");}return body_0;})();